#compdef vv

_arguments -C \
  '-S[Specify the socket to use]:socket path:->socket' \
  '--socket[Specify the socket to use]:socket path:->socket' \
  '-h[Show help and exit]' \
  '--help[Show help and exit]' \
  '1:mode:->mode' \
  '*:argument:' \
  && return

case $state in
  mode)
    local -a modes
    modes=(
      'attach:Attach to a velvet session'
      'lua:Execute lua code in a velvet session'
      'foreground:Start a velvet session without daemonizing'
    )
    _describe 'mode' modes
    ;;
  args)
    case $words[1] in
      lua)
        _arguments \
          '1:lua code:'
        ;;
      attach)
        _arguments \
          '*:arguments:'
        ;;
      *)
        _arguments \
          '*:arguments:'
        ;;
    esac
    ;;
esac

